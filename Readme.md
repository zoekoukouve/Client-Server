H κύρια διαμοιραζόμενη μνήμη μέσω της οποίας γίνονται γνωστά τα αιτήματα των clients στον server αποτελείται από τα εξής τμήματα:
    int file_num: ο αριθμός του ζητούμενου αρχείου, έτσι ώστε να ανακτηθεί.
    int start_line: ο αριθμός της ζητούμενης πρώτης γραμμής. 
    int end_line: αριθμός της ζητούμενης τελευταίας γραμμής. 
    int temp_mem_used: η μεταβλητή αυτή δηλώνει αν τα περιεχόμενα της κύριας μνήμης αντιστοιχούν σε αίτημα που πρέπει να εξυπηρετηθεί (1) ή σε κατάσταση που αναμένουμε για αίτημα. Η μεταβλητή αυτή εξυπερετεί στη ορθή λειτουργία της λούπας εξυπηρέτησης του server, εξαλείφοντας την πιθναότητα ένα αίτημα να εξυπηρετηθεί παραπάνω από μια φορά.
    int temp_shared_mem_key: ο αριθμός του κλειδιού που χρησιμοποιήθηκε από τον πελάτη για να κατασκευάσει την προσωρινή μνήμη.
    int finished: ο αριθμός των παιδιών-πελατών που έχουν ολοκληρωθεί. Η λούπα εξυπηρέτησης του server εκτελείται μέχρι να ολοκληρωθούν όλοι οι πελάτες. Όταν ένας πελάτης έχει εξυπηρετηθεί πληρώς σε όλα τα αιτήματα, αυξάνει αυτή τη μεταβλητή. 
    int sem_id: η χρησιμότητα της μεταβλητής αυτής θα γίνει κατανοητή παρακάτω.

Η προσωρινή διαμοιραζόμενη μνήμη είναι το μέγεθος της μέγιστης γραμμής.

Mutexes:
    mutex_writer: διαφυλλάσει όλα τα στοιχεία της κύριας μνήμης εκτός από το finished, έτσι ώστε μόνο μια διεργασία παιδί τη φορά να έχει πρόσβαση.
    mutex_finished: διαφυλλάσει το finished της κύριας μνήμης, έτσι ώστε μόνο μια διεργασία παιδί τη φορά να έχει πρόσβαση.
    mutex_diff: χρησιμοποιείται για να μπορούν οι πελάτες ειδοποιούν τον server για το ότι έκαναν ένα νέο αίτημα (στη κύρια μνήμη)
    semaph_r, semaph_w (πινακές): χρησιμοποιούνται για το συγχρονισμό των προσωρινών μνημών. Αναλυτικότερα, κάθε πελάτης δημιουργεί μια προσωρινή μνήμη, κάνει το αίτημά του στη κύρια μνήμη. Έπειτα ο server το εξυπηρετεί γράφοντας τηις κατάλληλες γραμμές στη προσωρινή μνήμη, ο πελάτης γράγει τις γραμμές αυτές στο αρχείο αποτελεσμάτων του και έπειτα διαγράφει τη μνήμη αυτή. Η διαδιακασία αυτή επαναλαμβάνεται για όλα τα αιτήματα. Επομένως, το πολύ μια προσωρινή διαμοιραζομενή μνήμη υπάρχει για έναν πελάτη κάποια στιγμή. Επέλεξα λοιπόν όλες οι κύριες μνήμες που θα δημιουργηθούν από τον ίδιο πελάτη να εξυπηρετηθούν από τους ίδιους σεμαφόρους. 
    
Εισαγωγή
Ο server δημιουργεί όλους τους σεμαφόρους που αναφέρθηκαν (με αρχικοποίηση στο 1 τους mutex_writer, mutex_finished, semaph_r και με αρχικοποίηση στο 0 τους mutex_diff και semaph_w), δημιουργεί την κύρια διαμοιραζόμενη μνήμη και κάνει fork για να δημιουργήσει τους πελάτες. Έπειτα εκτελεί μια λούπα εξυπηρέτησης των πελατών, η οποία περιγράφεταί αναλυτικά πιο κάτω. Για την εξυπηρέτηση κάθε αιτήματος χρησιμοποιείται ένα ξεχωριστό thread. Τέλος, εκτελεί το απαραίτητο καθαρισμό.  

Συγχρονισμός της κύριας μνήμης - υποβολή αιτημάτος - λούπα εξυπηρέτησης
1. Ο πελάτης επιλέγει (τυχαία) το αρχείο και τις γραμμές του αρχείου που θα ζητήσει.
2. Ο πελάτης κατασκευάζει μια προσωρινή μνήμη μήκους μιάς γραμμής η οποία θα χρησιμοποιηθεί για το πέρασμα του ζητούμενου κειμένου μεταξύ των συναρτήσεων. 
3. Ο πελάτης κατεβάζει τον σεμoφόρο mutex_writer για να ζητήσει πρόσβασή στην κύρια μνήμη.
4. Ο πελάτης τροποποιεί τα πεδία file_num, start_line, end_line, temp_mem_used, temp_shared_mem_key, sem_id.
5. Ο πελάτης ανεβάζει τον σεμoφόρο mutex_diff για να σημάνει στον server ότι υπάρχει νέο αίτημα που πρέπει να εξυπηρετηθεί.
6. Ο server κατεβάζει τον σεμoφόρο mutex_diff.
7. Ο server παίρνει από την κύρια διαμοιραζόμενη μνήμη τα απαραίρητα στοιχεία για την εξυπηρέτηση του αιτήματος.
8. Ο server κάνει attach  την συγκεκριμένη διεργασία στην προσωρινή μνήμη που δημιούργησε ο πελάτης.
9. Ο server εντοπίζει ποιο σεμαφόροι θα χρησιμποιηθούν από τους πίνακες semaph_r, semaph_w για την διαχείρηση της προσωρινής κύριας μνήμης μέσω του sem_id.
10. Με τις πληροφορίες που ανακτήθηκαν στα 7,8,9 ο server κατασκευάζει ένα προσωρινό αντοικείμενο για να σταλεί στο thread που θα ικανοποιήσει το αίτημα.
11. Ο server κατασκευάζει το thread που θα ικανοποιήσει το αίτημα. 
12. Ο server αλλάζει το temp_mem_used σε 0, για δείξει ότι μπορεί να δεχτει νεο αίτημα 
13.  Ο server ανεβάζει τον σεμoφόρο mutex_writer, για να μπορέσει ο επόμενος πελάτης να στείλει αίτημα.
Η λούπα αυτή επαναλαμβάνεται για όλα τα αιτήματα.

Ικανοποίηση αιτήματος - thread του server
Για i = 0; i < ζητούμενες γραμμές; i++
1. O server κατεβάζει τον σεμoφόρο semaph_w ζητόντας πρόσβαση για να γράψει στη προσωρινή μνήμη.
2. Ο server γράφει την i-στη γραμμή στη προσωρινή γραμμή.
3. Ο server ανεβάζει τον σεμoφόρο semaph_r.
4. Ο πελάτης κατεβάζει τον σεμoφόρο semaph_r και γράγει την γραμμή που υπάρχει στη κύρια μνήμη στο writefile του ()
5. Ο πελάτης ανεβάζει τον σεμoφόρο semaph_w, για νπορέσει ο server να του στείλει την επόμενη γραμμή.
Τέλος_για
Έπειτα και οι δύο συμμετέχοντες κάνουν detach από την προσωρινή μνήμη και ο πελάτης τη διαγράφει.

Δομή προγράμματος
Το πρόγραμμα αποτελείται από τα πηγαία αρχεία parent_threads.cpp clients.cpp aid_functions.cpp και τα
header αρχεία shared_memory.h aid_functions.h.
parent_threads.cpp: Περιέχει μια συνάρτηση main η οποία χηριμοποείται για να λάβει τα arguments εκτέλεσης, μια συνάρτηση parent που υλοποιεί τον πολυνηματικό server οπώς περιγράφεται στις παραγράφους "Εισαγωγή", "Συγχρονισμός της κύριας μνήμης - υποβολή αιτημάτος - λούπα εξυπηρέτησης" και μια συνάρτηση threadFunction η οποία υλοποιί κάθε ξεχωριστό thread του server πώς περιγράφεται στις παραγράφους "Ικανοποίηση αιτήματος - thread του server".
clients.c: Περιέχει τον κώδικα κάθε διαδικασίας πελάτη.
aid_functions.cpp: Περιέχει βοηθητικές συναρτήσεις.
shared_memory.h: Περιέχει το shared memory.
Υπάρχει MakeFile, οπότε η μεταγλώττιση του εκτελέσιμου γίνεται με την εντολή “make” και η εκτέλεση με μια εντολή της μορφής 
./server clients files_amounts requests lamda filenames
πχ ./server 20 2 7 0.05 example.txt notes.txt

Σχόλια
Κάθε πελάτης έχει το δικό του αρχείο απατήσεων (writefile).